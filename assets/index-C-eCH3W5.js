(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();class K{x;y;w;h;speed;flashFrame=0;constructor(e,i,n,s){this.x=e,this.y=i,this.w=n,this.h=s,this.speed=10}move(){this.x+=this.speed,this.flashFrame++}draw(e){if(this.flashFrame<3){e.save(),e.translate(this.x+this.w/2,this.y+this.h/2),e.globalAlpha=.8-this.flashFrame*.3,e.shadowColor="yellow",e.shadowBlur=8,e.fillStyle="yellow",e.beginPath();const i=5,n=this.w*1.2,s=this.w*.4;for(let o=0;o<i*2;o++){const h=o%2===0?n:s,O=o*Math.PI/i;e.lineTo(Math.cos(O)*h,Math.sin(O)*h)}e.closePath(),e.fill(),e.restore()}e.fillStyle="gray",e.fillRect(this.x,this.y,this.w,this.h),e.fillStyle="black",e.fillRect(this.x+this.w*.25,this.y,this.w*.5,this.h),e.strokeStyle="white",e.lineWidth=1,e.strokeRect(this.x,this.y,this.w,this.h)}isOnScreen(e){return this.x+this.w>0&&this.x<e.width&&this.y+this.h>0&&this.y<e.height}}class z{x;y;w;h;speed;image;level;stepFrame=0;isMoving=!1;constructor(e,i,n,s,o,h){this.x=e,this.y=i,this.image=o,this.w=n,this.h=s,this.speed=h,this.level=1}draw(e){let i=0;this.isMoving&&(i=Math.sin(this.stepFrame*1)*1.5),e.drawImage(this.image,this.x,this.y+i,this.w,this.h)}control(e){switch(this.isMoving=!1,e){case"left":this.x-=this.speed,this.isMoving=!0;break;case"right":this.x+=this.speed,this.isMoving=!0;break;case"up":this.y-=this.speed,this.isMoving=!0;break;case"down":this.y+=this.speed,this.isMoving=!0;break}this.isMoving?this.stepFrame++:this.stepFrame=0}checkCollisionBounds(e){this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.w>e.width&&(this.x=e.width-this.w),this.y+this.h>e.height&&(this.y=e.height-this.h)}fire(){return this.y-=this.speed,setTimeout(()=>{this.y+=this.speed},100),new K(this.x+100,this.y+50,20,10)}}class D{x;y;w;h;speed;image;walkTime=0;constructor(e,i,n,s,o,h){this.x=e,this.y=i,this.image=o,this.w=n,this.h=s,this.speed=h}draw(e){this.walkTime+=.3;const i=Math.sin(this.walkTime)*2.5;e.drawImage(this.image,this.x,this.y+i,this.w,this.h)}move(){this.x-=this.speed}}const k={player:new Image,enemyKurvinox:new Image,heart:new Image};k.player.src="../../public/images/player.png";k.enemyKurvinox.src="../../public/images/enemyKurvinox.png";k.heart.src="../../public/images/heart.png";let I="none";const A=new Set,p={ArrowLeft:"left",a:"left",A:"left",ArrowRight:"right",d:"right",D:"right",ArrowUp:"up",w:"up",W:"up",ArrowDown:"down",s:"down",S:"down"};document.addEventListener("keydown",function(t){p[t.key]&&(A.add(t.key),I=p[t.key])});document.addEventListener("keyup",function(t){if(p[t.key]){A.delete(t.key);let e=!1;for(const i of A)if(p[i]){I=p[i],e=!0;break}e||(I="none")}});const M={shot:new Audio,okrzyk:new Audio,over:new Audio};M.shot.src="../../public/sounds/shot.mp3";M.okrzyk.src="../../public/sounds/krzykBomba.mp3";M.over.src="../../public/sounds/over.mp3";function S(t){const e=M[t].src;if(!e)return;const i=new Audio(e);i.currentTime=0,i.play()}function C(t){const e=document.getElementById("score");e&&(e.textContent=`${t}`)}function x(t){const e=document.getElementById("lives");e&&(t<=0?e.innerHTML="":e.innerHTML=Array(t+1).join('<img id="hearts" src="./public/images/heart.png" alt="heart">'))}const r={x:0,y:0,w:300,h:60};function G(t,e,i){t.save(),t.globalAlpha=.7,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.restore(),t.fillStyle="#fff",t.font="bold 64px Arial",t.textAlign="center",t.fillText("GAME OVER!",e.width/2,e.height/2-60),t.font="bold 32px Arial",t.fillText(`Ustrzelone kurwinoxy: ${i}`,e.width/2,e.height/2-10),r.x=e.width/2-r.w/2,r.y=e.height/2+30,t.fillStyle="yellow",t.strokeStyle="#fff",t.lineWidth=4,t.fillRect(r.x,r.y,r.w,r.h),t.strokeRect(r.x,r.y,r.w,r.h),t.fillStyle="#222",t.font="bold 32px Arial",t.fillText("start",e.width/2,r.y+r.h/2+12)}const a=document.getElementById("canvas"),m=a.getContext("2d"),f=[],d=[];let v=0,y=3,l,g=2e3,c,w,u=!1,R=100,B=100;function F(){l=new z(200,200,120,120,k.player,5),x(y)}function T(){if(m.clearRect(0,0,a.width,a.height),u){S("over"),G(m,a,v);return}l.control(I),l.draw(m),l.checkCollisionBounds(a);for(let t=d.length-1;t>=0;t--){let e=d[t];e.move(),e.draw(m),e.x+e.w<0&&d.splice(t,1)}for(let t=f.length-1;t>=0;t--)f[t].isOnScreen(a)||f.splice(t,1);for(const t of f)t.move(),t.draw(m);H(),requestAnimationFrame(T)}function E(){c!==void 0&&clearInterval(c),c=setInterval(()=>{u||Y()},g)}function Y(){const t=Math.random()*(a.height-B);d.push(new D(a.width-R,t,R,B,k.enemyKurvinox,5))}function H(){for(let t=d.length-1;t>=0;t--){let e=d[t];if(l.x+l.w/2>=e.x&&l.x<e.x&&l.y<=e.y+e.h&&l.y+l.h>=e.y){if(d.splice(t,1),y-=1,x(y),y<=0){W();return}continue}for(let i=f.length-1;i>=0;i--){let n=f[i],s=n.y+n.h/2;if(n.x+n.w>=e.x&&n.x+n.w<=e.x+e.w&&s>=e.y&&s<=e.y+e.h){f.splice(i,1),d.splice(t,1),v+=1,C(v);break}}}}function P(){w!==void 0&&clearInterval(w),w=setInterval(()=>{!u&&g>200&&(g=Math.max(200,g-200),E())},1e4)}function W(){u=!0,c!==void 0&&(clearInterval(c),c=void 0),w!==void 0&&(clearInterval(w),w=void 0),d.length=0,f.length=0}function N(){v=0,y=3,g=2e3,u=!1,C(v),x(y),F(),d.length=0,f.length=0,E(),P(),T()}a.addEventListener("click",function(t){if(!u)return;const e=a.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;i>=r.x&&i<=r.x+r.w&&n>=r.y&&n<=r.y+r.h&&N()});let L=null,b=null;window.addEventListener("keydown",t=>{if(t.key.toLowerCase()==="e"&&!u){L===null&&(L=Date.now(),b=window.setTimeout(()=>{S("okrzyk")},1e3)),S("shot");let e=l.fire();f.push(e)}});window.addEventListener("keyup",t=>{t.key.toLowerCase()==="e"&&(L=null,b!==null&&(clearTimeout(b),b=null))});F();E();P();T();
