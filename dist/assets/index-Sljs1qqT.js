(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();class ${x;y;w;h;speed;flashFrame=0;constructor(e,s,r,i,o){this.x=e,this.y=s,this.w=r,this.h=i,this.speed=o}move(){this.x+=this.speed,this.flashFrame++}draw(e){if(this.flashFrame<3){e.save(),e.translate(this.x+this.w/2,this.y+this.h/2),e.globalAlpha=.8-this.flashFrame*.3,e.shadowColor="yellow",e.shadowBlur=8,e.fillStyle="yellow",e.beginPath();const s=5,r=this.w*1.2,i=this.w*.4;for(let o=0;o<s*2;o++){const l=o%2===0?r:i,f=o*Math.PI/s;e.lineTo(Math.cos(f)*l,Math.sin(f)*l)}e.closePath(),e.fill(),e.restore()}e.fillStyle="gray",e.fillRect(this.x,this.y,this.w,this.h),e.fillStyle="black",e.fillRect(this.x+this.w*.25,this.y,this.w*.5,this.h),e.strokeStyle="white",e.lineWidth=1,e.strokeRect(this.x,this.y,this.w,this.h)}isOnScreen(e){return this.x+this.w>0&&this.x<e.width&&this.y+this.h>0&&this.y<e.height}}class F{x;y;w;h;image;speed;lives;walkTime=0;constructor(e,s,r,i,o,l,f){this.x=e,this.y=s,this.w=r,this.h=i,this.image=o,this.speed=l,this.lives=f}draw(e){e.drawImage(this.image,this.x,this.y,this.w,this.h)}walkEffect(){this.walkTime+=.5,this.y+=Math.sin(this.walkTime)}}class X extends F{isMoving=!1;money=0;monstersKilled=0;ammoSpeed=5;constructor(e,s,r,i,o,l,f){super(e,s,r,i,o,l,f),this.money=this.money,this.monstersKilled=this.monstersKilled}control(e){switch(e){case"left":this.x-=this.speed,this.walkEffect();break;case"right":this.x+=this.speed,this.walkEffect();break;case"up":this.y-=this.speed,this.walkEffect();break;case"down":this.y+=this.speed,this.walkEffect();break}}checkCollisionBounds(e){this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.w>e.width&&(this.x=e.width-this.w),this.y+this.h>e.height&&(this.y=e.height-this.h)}fire(){return this.y-=this.speed,setTimeout(()=>{this.y+=this.speed},100),[new $(this.x+100,this.y+50,20,10,this.ammoSpeed)]}addLives(e){this.lives+=e}addSpeed(e){this.speed+=e}addAmmoSpeed(e){this.ammoSpeed+=e}spendMoney(e){return this.money>=e?(this.money-=e,!0):!1}}function M(t){const e=document.getElementById("shopAlert");e&&(e.textContent=t,setTimeout(()=>{e.textContent=""},2e3))}class j{constructor(){}buyHealth(e){return e.spendMoney(1)?(e.addLives(1),!0):(M("Nie masz środków!"),!1)}buySpeed(e){return e.spendMoney(1)?(e.addSpeed(1),!0):(M("Nie masz środków!"),!1)}buyAmmoSpeed(e){return e.spendMoney(0)?(e.addAmmoSpeed(1),!0):(M("Nie masz środków!"),!1)}}class U extends F{damage;constructor(e,s,r,i,o,l,f,x){super(e,s,r,i,o,l,f),this.damage=x}move(){this.x-=this.speed,this.walkEffect()}draw(e){if(e.drawImage(this.image,this.x,this.y,this.w,this.h),this.damage>0){const i=this.x,o=this.y-4-10;for(let l=0;l<this.lives;l++){const f=i+l*11,x=o;e.fillStyle="red",e.beginPath(),e.arc(f+4,x+4,4,0,Math.PI*2),e.fill()}}}}const y={player:new Image,enemyKurvinox:new Image,galaktyka:new Image,heart:new Image,poop:new Image},b="images/";y.player.src=b+"player.png";y.enemyKurvinox.src=b+"enemyKurvinox.png";y.galaktyka.src=b+"galaktyka.png";y.poop.src=b+"poop.png";let I="none";const T=new Set,v={ArrowLeft:"left",a:"left",A:"left",ArrowRight:"right",d:"right",D:"right",ArrowUp:"up",w:"up",W:"up",ArrowDown:"down",s:"down",S:"down"};document.addEventListener("keydown",function(t){v[t.key]&&(T.add(t.key),I=v[t.key])});document.addEventListener("keyup",function(t){if(v[t.key]){T.delete(t.key);let e=!1;for(const s of T)if(v[s]){I=v[s],e=!0;break}e||(I="none")}});const A={shot:new Audio,okrzyk:new Audio,over:new Audio},P="sounds/";A.shot.src=P+"shot.mp3";A.okrzyk.src=P+"krzykBomba.mp3";A.over.src=P+"over.mp3";function K(t){const e=A[t].src;if(!e)return;const s=new Audio(e);s.currentTime=0,s.play()}function z(t){const e=document.getElementById("score");e&&(e.textContent=`${t}`)}function L(t){const e=document.getElementById("lives");e&&(t<=0?e.innerHTML="":e.innerHTML=Array(t+1).join('<img id="hearts" src="images/heart.png" alt="heart">'))}function O(t){const e=document.getElementById("poop");e&&(e.textContent=`${t}`)}const a={x:0,y:0,w:300,h:60};function V(t,e,s){t.save(),t.globalAlpha=.7,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.restore(),t.fillStyle="#fff",t.font="bold 64px Arial",t.textAlign="center",t.fillText("GAME OVER!",e.width/2,e.height/2-60),t.font="bold 32px Arial",t.fillText(`Ustrzelone kurwinoxy: ${s}`,e.width/2,e.height/2-10),a.x=e.width/2-a.w/2,a.y=e.height/2+30,t.fillStyle="yellow",t.strokeStyle="#fff",t.lineWidth=4,t.fillRect(a.x,a.y,a.w,a.h),t.strokeRect(a.x,a.y,a.w,a.h),t.fillStyle="#222",t.font="bold 32px Arial",t.fillText("start",e.width/2,a.y+a.h/2+12)}const d=document.getElementById("canvas"),u=d.getContext("2d"),c=[],h=[];let n,k=1e3,w,g,p=!1,D=100,N=100,q=50,E=1,m;function G(){n=new X(200,200,120,120,y.player,5,3),L(n.lives),z(n.monstersKilled)}function R(){if(u.clearRect(0,0,d.width,d.height),u.save(),u.globalAlpha=.5,u.drawImage(y.galaktyka,0,0,d.width,d.height),u.restore(),p){K("over"),V(u,d,n.monstersKilled);return}n.control(I),n.draw(u),n.checkCollisionBounds(d);for(let t=h.length-1;t>=0;t--){let e=h[t];e.move(),e.draw(u),e.x+e.w<0&&h.splice(t,1)}for(let t=c.length-1;t>=0;t--)c[t].isOnScreen(d)||c.splice(t,1);for(const t of c)t.move(),t.draw(u);Q(),requestAnimationFrame(R)}function H(){w!==void 0&&clearInterval(w),w=setInterval(()=>{p||J()},k)}function J(){const t=Math.random()*(d.height-N);h.push(new U(d.width-D,t,D,N,y.enemyKurvinox,1,E,1))}function Q(){for(let t=h.length-1;t>=0;t--){let e=h[t];if(Z(e)){if(e.damage===0)n.money+=1,O(n.money),h.splice(t,1);else if(n.lives-=e.damage,L(n.lives),h.splice(t,1),n.lives<=0){ee();return}}}for(let t=c.length-1;t>=0;t--){let e=c[t],s=!1;for(let r=h.length-1;r>=0;r--){let i=h[r];if(_(e,i)&&(i.lives-=1,i.damage>0&&(s=!0,i.lives==0))){Math.random()<.2?(i.damage=0,i.speed=0,i.image=y.poop):(h.splice(r,1),n.monstersKilled+=1,z(n.monstersKilled));break}}s&&c.splice(t,1)}}function Z(t){return n.x<t.x+t.w-q&&n.x+n.w>t.x+q&&n.y<t.y+t.h&&n.y+n.h>t.y}function _(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}function W(){g!==void 0&&clearInterval(g),g=setInterval(()=>{!p&&k>200&&(k=Math.max(200,k-25),H())},1e4)}function Y(){m!==void 0&&clearInterval(m),m=setInterval(()=>{!p&&E<6&&(E+=1)},2e4)}function ee(){p=!0,w!==void 0&&(clearInterval(w),w=void 0),g!==void 0&&(clearInterval(g),g=void 0),m!==void 0&&(clearInterval(m),m=void 0),h.length=0,c.length=0}function te(){k=2e3,p=!1,E=1,G(),O(n.money),L(n.lives),z(n.monstersKilled),h.length=0,c.length=0,m!==void 0&&(clearInterval(m),m=void 0),H(),W(),Y(),R()}d.addEventListener("click",function(t){if(!p)return;const e=d.getBoundingClientRect(),s=t.clientX-e.left,r=t.clientY-e.top;s>=a.x&&s<=a.x+a.w&&r>=a.y&&r<=a.y+a.h&&te()});let C=null,S=null;window.addEventListener("keydown",t=>{if(t.key.toLowerCase()==="e"&&!p){C===null&&(C=Date.now(),S=window.setTimeout(()=>{K("okrzyk")},1e3)),K("shot");const e=n.fire();for(const s of e)c.push(s)}});window.addEventListener("keyup",t=>{t.key.toLowerCase()==="e"&&(C=null,S!==null&&(clearTimeout(S),S=null))});let B;function ie(){B=new j}document.querySelectorAll(".shopItem[data-type]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-type");e&&se(e)})});function se(t){switch(t){case"ammo":break;case"fasterShooting":B.buyAmmoSpeed(n);break;case"life":B.buyHealth(n),L(n.lives);break}O(n.money)}function oe(t){Object.entries(t).forEach(([s,r])=>{const i=document.querySelector(`.itemProgress[data-type="${s}"]`);if(i){i.innerHTML="";for(let o=0;o<5;o++){const l=document.createElement("div");l.className="progressSquare"+(o<r?" filled":""),i.appendChild(l)}}})}function ne(){oe({ammo:0,fasterShooting:n.ammoSpeed-20,life:n.lives-3,upgradeWeapon:0})}G();ie();H();W();Y();R();ne();
