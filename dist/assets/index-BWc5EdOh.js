(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();class b{x;y;w;h;speed;flashFrame=0;constructor(e,s,r,i,n){this.x=e,this.y=s,this.w=r,this.h=i,this.speed=n}move(){this.x+=this.speed,this.flashFrame++}draw(e){if(this.flashFrame<3){e.save(),e.translate(this.x+this.w/2,this.y+this.h/2),e.globalAlpha=.8-this.flashFrame*.3,e.shadowColor="yellow",e.shadowBlur=8,e.fillStyle="yellow",e.beginPath();const s=5,r=this.w*1.2,i=this.w*.4;for(let n=0;n<s*2;n++){const a=n%2===0?r:i,u=n*Math.PI/s;e.lineTo(Math.cos(u)*a,Math.sin(u)*a)}e.closePath(),e.fill(),e.restore()}e.fillStyle="gray",e.fillRect(this.x,this.y,this.w,this.h),e.fillStyle="black",e.fillRect(this.x+this.w*.25,this.y,this.w*.5,this.h),e.strokeStyle="white",e.lineWidth=1,e.strokeRect(this.x,this.y,this.w,this.h)}isOnScreen(e){return this.x+this.w>0&&this.x<e.width&&this.y+this.h>0&&this.y<e.height}}class H{x;y;w;h;image;speed;lives;walkTime=0;constructor(e,s,r,i,n,a,u){this.x=e,this.y=s,this.w=r,this.h=i,this.image=n,this.speed=a,this.lives=u}draw(e){e.drawImage(this.image,this.x,this.y,this.w,this.h)}walkEffect(){this.walkTime+=.5,this.y+=Math.sin(this.walkTime)}}class F extends H{isMoving=!1;money=0;monstersKilled=0;ammoSpeed=10;constructor(e,s,r,i,n,a,u){super(e,s,r,i,n,a,u),this.money=this.money,this.monstersKilled=this.monstersKilled}control(e){switch(e){case"left":this.x-=this.speed,this.walkEffect();break;case"right":this.x+=this.speed,this.walkEffect();break;case"up":this.y-=this.speed,this.walkEffect();break;case"down":this.y+=this.speed,this.walkEffect();break}}checkCollisionBounds(e){this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.w>e.width&&(this.x=e.width-this.w),this.y+this.h>e.height&&(this.y=e.height-this.h)}fire(){return this.y-=this.speed,setTimeout(()=>{this.y+=this.speed},100),[new b(this.x+100,this.y+25,20,10,this.ammoSpeed),new b(this.x+100,this.y+50,20,10,this.ammoSpeed),new b(this.x+100,this.y+75,20,10,this.ammoSpeed)]}addLives(e){this.lives+=e}addSpeed(e){this.speed+=e}addAmmoSpeed(e){this.ammoSpeed+=e}spendMoney(e){return this.money>=e?(this.money-=e,!0):!1}}function I(t){const e=document.getElementById("shopAlert");e&&(e.textContent=t,setTimeout(()=>{e.textContent=""},2e3))}class G{constructor(){}buyHealth(e){return e.spendMoney(1)?(e.addLives(1),!0):(I("Nie masz środków!"),!1)}buySpeed(e){return e.spendMoney(1)?(e.addSpeed(1),!0):(I("Nie masz środków!"),!1)}buyAmmoSpeed(e){return e.spendMoney(0)?(e.addAmmoSpeed(1),!0):(I("Nie masz środków!"),!1)}}class W extends H{damage;constructor(e,s,r,i,n,a,u,q){super(e,s,r,i,n,a,u),this.damage=q}move(){this.x-=this.speed,this.walkEffect()}}const m={player:new Image,enemyKurvinox:new Image,galaktyka:new Image,heart:new Image,poop:new Image};m.player.src="images/player.png";m.enemyKurvinox.src="images/enemyKurvinox.png";m.galaktyka.src="images/galaktyka.png";m.poop.src="images/poop.png";let S="none";const x=new Set,g={ArrowLeft:"left",a:"left",A:"left",ArrowRight:"right",d:"right",D:"right",ArrowUp:"up",w:"up",W:"up",ArrowDown:"down",s:"down",S:"down"};document.addEventListener("keydown",function(t){g[t.key]&&(x.add(t.key),S=g[t.key])});document.addEventListener("keyup",function(t){if(g[t.key]){x.delete(t.key);let e=!1;for(const s of x)if(g[s]){S=g[s],e=!0;break}e||(S="none")}});const E={shot:new Audio,okrzyk:new Audio,over:new Audio};E.shot.src="sounds/shot.mp3";E.okrzyk.src="sounds/krzykBomba.mp3";E.over.src="sounds/over.mp3";function L(t){const e=E[t].src;if(!e)return;const s=new Audio(e);s.currentTime=0,s.play()}function K(t){const e=document.getElementById("score");e&&(e.textContent=`${t}`)}function A(t){const e=document.getElementById("lives");e&&(t<=0?e.innerHTML="":e.innerHTML=Array(t+1).join('<img id="hearts" src="images/heart.png" alt="heart">'))}function C(t){const e=document.getElementById("poop");e&&(e.textContent=`${t}`)}const l={x:0,y:0,w:300,h:60};function $(t,e,s){t.save(),t.globalAlpha=.7,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.restore(),t.fillStyle="#fff",t.font="bold 64px Arial",t.textAlign="center",t.fillText("GAME OVER!",e.width/2,e.height/2-60),t.font="bold 32px Arial",t.fillText(`Ustrzelone kurwinoxy: ${s}`,e.width/2,e.height/2-10),l.x=e.width/2-l.w/2,l.y=e.height/2+30,t.fillStyle="yellow",t.strokeStyle="#fff",t.lineWidth=4,t.fillRect(l.x,l.y,l.w,l.h),t.strokeRect(l.x,l.y,l.w,l.h),t.fillStyle="#222",t.font="bold 32px Arial",t.fillText("start",e.width/2,l.y+l.h/2+12)}const d=document.getElementById("canvas"),c=d.getContext("2d"),f=[],h=[];let o,k=2e3,p,w,y=!1,P=100,R=100,z=50;function D(){o=new F(200,200,120,120,m.player,5,3),A(o.lives),K(o.monstersKilled)}function B(){if(c.clearRect(0,0,d.width,d.height),c.save(),c.globalAlpha=.5,c.drawImage(m.galaktyka,0,0,d.width,d.height),c.restore(),y){L("over"),$(c,d,o.monstersKilled);return}o.control(S),o.draw(c),o.checkCollisionBounds(d);for(let t=h.length-1;t>=0;t--){let e=h[t];e.move(),e.draw(c),e.x+e.w<0&&h.splice(t,1)}for(let t=f.length-1;t>=0;t--)f[t].isOnScreen(d)||f.splice(t,1);for(const t of f)t.move(),t.draw(c);Y(),requestAnimationFrame(B)}function O(){p!==void 0&&clearInterval(p),p=setInterval(()=>{y||j()},k)}function j(){const t=Math.random()*(d.height-R);h.push(new W(d.width-P,t,P,R,m.enemyKurvinox,1,1,1))}function Y(){for(let t=h.length-1;t>=0;t--){let e=h[t];if(U(e)){if(e.damage===0)o.money+=1,C(o.money),h.splice(t,1);else if(o.lives-=e.damage,A(o.lives),h.splice(t,1),o.lives<=0){V();return}}}for(let t=f.length-1;t>=0;t--){let e=f[t],s=!1;for(let r=h.length-1;r>=0;r--){let i=h[r];if(X(e,i)&&i.damage>0){s=!0,Math.random()<.2?(i.damage=0,i.speed=0,i.image=m.poop):(h.splice(r,1),o.monstersKilled+=1,K(o.monstersKilled));break}}s&&f.splice(t,1)}}function U(t){return o.x<t.x+t.w-z&&o.x+o.w>t.x+z&&o.y<t.y+t.h&&o.y+o.h>t.y}function X(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}function N(){w!==void 0&&clearInterval(w),w=setInterval(()=>{!y&&k>200&&(k=Math.max(200,k-200),O())},1e4)}function V(){y=!0,p!==void 0&&(clearInterval(p),p=void 0),w!==void 0&&(clearInterval(w),w=void 0),h.length=0,f.length=0}function J(){k=2e3,y=!1,D(),C(o.money),A(o.lives),K(o.monstersKilled),h.length=0,f.length=0,O(),N(),B()}d.addEventListener("click",function(t){if(!y)return;const e=d.getBoundingClientRect(),s=t.clientX-e.left,r=t.clientY-e.top;s>=l.x&&s<=l.x+l.w&&r>=l.y&&r<=l.y+l.h&&J()});let M=null,v=null;window.addEventListener("keydown",t=>{if(t.key.toLowerCase()==="e"&&!y){M===null&&(M=Date.now(),v=window.setTimeout(()=>{L("okrzyk")},1e3)),L("shot");const e=o.fire();for(const s of e)f.push(s)}});window.addEventListener("keyup",t=>{t.key.toLowerCase()==="e"&&(M=null,v!==null&&(clearTimeout(v),v=null))});let T;function Q(){T=new G}document.querySelectorAll(".shopItem[data-type]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-type");e&&Z(e)})});function Z(t){switch(t){case"ammo":break;case"fasterShooting":T.buyAmmoSpeed(o);break;case"life":T.buyHealth(o),A(o.lives);break}C(o.money)}function _(t){Object.entries(t).forEach(([s,r])=>{const i=document.querySelector(`.itemProgress[data-type="${s}"]`);if(i){i.innerHTML="";for(let n=0;n<5;n++){const a=document.createElement("div");a.className="progressSquare"+(n<r?" filled":""),i.appendChild(a)}}})}function ee(){_({ammo:0,fasterShooting:o.ammoSpeed-20,life:o.lives-3,upgradeWeapon:0})}D();Q();O();N();B();ee();
