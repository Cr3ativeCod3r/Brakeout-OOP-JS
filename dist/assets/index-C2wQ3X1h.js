(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();class j{x;y;w;h;speed;flashFrame=0;constructor(e,s,r,i,n){this.x=e,this.y=s,this.w=r,this.h=i,this.speed=n}move(){this.x+=this.speed,this.flashFrame++}draw(e){if(this.flashFrame<3){e.save(),e.translate(this.x+this.w/2,this.y+this.h/2),e.globalAlpha=.8-this.flashFrame*.3,e.shadowColor="yellow",e.shadowBlur=8,e.fillStyle="yellow",e.beginPath();const s=5,r=this.w*1.2,i=this.w*.4;for(let n=0;n<s*2;n++){const l=n%2===0?r:i,f=n*Math.PI/s;e.lineTo(Math.cos(f)*l,Math.sin(f)*l)}e.closePath(),e.fill(),e.restore()}e.fillStyle="gray",e.fillRect(this.x,this.y,this.w,this.h),e.fillStyle="black",e.fillRect(this.x+this.w*.25,this.y,this.w*.5,this.h),e.strokeStyle="white",e.lineWidth=1,e.strokeRect(this.x,this.y,this.w,this.h)}isOnScreen(e){return this.x+this.w>0&&this.x<e.width&&this.y+this.h>0&&this.y<e.height}}class ${x;y;w;h;image;speed;lives;walkTime=0;constructor(e,s,r,i,n,l,f){this.x=e,this.y=s,this.w=r,this.h=i,this.image=n,this.speed=l,this.lives=f}draw(e){e.drawImage(this.image,this.x,this.y,this.w,this.h)}walkEffect(){this.walkTime+=.5,this.y+=Math.sin(this.walkTime)}}function z(t){const e=document.getElementById("score");e&&(e.textContent=`${t}`)}function L(t){const e=document.getElementById("lives");e&&(t<=0?e.innerHTML="":e.innerHTML=Array(t+1).join('<img id="hearts" src="images/heart.png" alt="heart">'))}function P(t){const e=document.getElementById("poop");e&&(e.textContent=`${t}`)}function O(t){const e=document.getElementById("ammo");e&&(e.textContent=`${t}`)}class U extends ${isMoving=!1;money=0;monstersKilled=0;ammoSpeed=5;ammos=100;constructor(e,s,r,i,n,l,f){super(e,s,r,i,n,l,f),this.money=this.money,this.monstersKilled=this.monstersKilled}control(e){switch(e){case"left":this.x-=this.speed,this.walkEffect();break;case"right":this.x+=this.speed,this.walkEffect();break;case"up":this.y-=this.speed,this.walkEffect();break;case"down":this.y+=this.speed,this.walkEffect();break}}checkCollisionBounds(e){this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.w>e.width&&(this.x=e.width-this.w),this.y+this.h>e.height&&(this.y=e.height-this.h)}fire(){return this.ammos?(this.y-=this.speed,setTimeout(()=>{this.y+=this.speed},100),this.ammos-=1,O(this.ammos),[new j(this.x+100,this.y+50,20,10,this.ammoSpeed)]):[]}addLives(e){this.lives+=e}addSpeed(e){this.speed+=e}addAmmoSpeed(e){this.ammoSpeed+=e}addAmmo(e){this.ammos+=e}spendMoney(e){return this.money>=e?(this.money-=e,!0):!1}}function S(t){const e=document.getElementById("shopAlert");e&&(e.textContent=t,setTimeout(()=>{e.textContent=""},2e3))}class V{constructor(){}buyHealth(e){return e.spendMoney(5)?(e.addLives(1),!0):(S("Nie masz środków!"),!1)}buySpeed(e){return e.spendMoney(1)?(e.addSpeed(1),!0):(S("Nie masz środków!"),!1)}buyAmmo(e){return e.spendMoney(1)?(e.addAmmo(50),!0):(S("Nie masz środków!"),!1)}buyAmmoSpeed(e){return e.spendMoney(10)?(e.addAmmoSpeed(1),!0):(S("Nie masz środków!"),!1)}}class J extends ${damage;constructor(e,s,r,i,n,l,f,T){super(e,s,r,i,n,l,f),this.damage=T}move(){this.x-=this.speed,this.walkEffect()}draw(e){if(e.drawImage(this.image,this.x,this.y,this.w,this.h),this.damage>0){const i=this.x,n=this.y-4-10;for(let l=0;l<this.lives;l++){const f=i+l*11,T=n;e.fillStyle="red",e.beginPath(),e.arc(f+4,T+4,4,0,Math.PI*2),e.fill()}}}}const y={player:new Image,enemyKurvinox:new Image,galaktyka:new Image,heart:new Image,poop:new Image},x="images/";y.player.src=x+"player.png";y.enemyKurvinox.src=x+"enemyKurvinox.png";y.galaktyka.src=x+"galaktyka.png";y.poop.src=x+"poop.png";let E="none";const C=new Set,v={ArrowLeft:"left",a:"left",A:"left",ArrowRight:"right",d:"right",D:"right",ArrowUp:"up",w:"up",W:"up",ArrowDown:"down",s:"down",S:"down"};document.addEventListener("keydown",function(t){v[t.key]&&(C.add(t.key),E=v[t.key])});document.addEventListener("keyup",function(t){if(v[t.key]){C.delete(t.key);let e=!1;for(const s of C)if(v[s]){E=v[s],e=!0;break}e||(E="none")}});const M={shot:new Audio,okrzyk:new Audio,over:new Audio},R="sounds/";M.shot.src=R+"shot.mp3";M.okrzyk.src=R+"krzykBomba.mp3";M.over.src=R+"over.mp3";function K(t){const e=M[t].src;if(!e)return;const s=new Audio(e);s.currentTime=0,s.play()}const a={x:0,y:0,w:300,h:60};function Q(t,e,s){t.save(),t.globalAlpha=.7,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.restore(),t.fillStyle="#fff",t.font="bold 64px Arial",t.textAlign="center",t.fillText("GAME OVER!",e.width/2,e.height/2-60),t.font="bold 32px Arial",t.fillText(`Ustrzelone kurwinoxy: ${s}`,e.width/2,e.height/2-10),a.x=e.width/2-a.w/2,a.y=e.height/2+30,t.fillStyle="yellow",t.strokeStyle="#fff",t.lineWidth=4,t.fillRect(a.x,a.y,a.w,a.h),t.strokeRect(a.x,a.y,a.w,a.h),t.fillStyle="#222",t.font="bold 32px Arial",t.fillText("start",e.width/2,a.y+a.h/2+12)}const d=document.getElementById("canvas"),m=d.getContext("2d"),c=[],h=[];let o,k=1e3,w,g,p=!1,D=100,q=100,F=50,b=1,u;function G(){o=new U(200,200,120,120,y.player,5,3),L(o.lives),O(o.ammos),z(o.monstersKilled)}function H(){if(m.clearRect(0,0,d.width,d.height),m.save(),m.globalAlpha=.5,m.drawImage(y.galaktyka,0,0,d.width,d.height),m.restore(),p){K("over"),Q(m,d,o.monstersKilled);return}o.control(E),o.draw(m),o.checkCollisionBounds(d);for(let t=h.length-1;t>=0;t--){let e=h[t];e.move(),e.draw(m),e.x+e.w<0&&h.splice(t,1)}for(let t=c.length-1;t>=0;t--)c[t].isOnScreen(d)||c.splice(t,1);for(const t of c)t.move(),t.draw(m);_(),requestAnimationFrame(H)}function N(){w!==void 0&&clearInterval(w),w=setInterval(()=>{p||Z()},k)}function Z(){const t=Math.random()*(d.height-q);h.push(new J(d.width-D,t,D,q,y.enemyKurvinox,1,b,1))}function _(){for(let t=h.length-1;t>=0;t--){let e=h[t];if(ee(e)){if(e.damage===0)o.money+=1,P(o.money),h.splice(t,1);else if(o.lives-=e.damage,L(o.lives),h.splice(t,1),o.lives<=0){ie();return}}}for(let t=c.length-1;t>=0;t--){let e=c[t],s=!1;for(let r=h.length-1;r>=0;r--){let i=h[r];if(te(e,i)&&(i.lives-=1,i.damage>0&&(s=!0,i.lives==0))){Math.random()<.2?(i.damage=0,i.speed=0,i.image=y.poop):(h.splice(r,1),o.monstersKilled+=1,z(o.monstersKilled));break}}s&&c.splice(t,1)}}function ee(t){return o.x<t.x+t.w-F&&o.x+o.w>t.x+F&&o.y<t.y+t.h&&o.y+o.h>t.y}function te(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}function W(){g!==void 0&&clearInterval(g),g=setInterval(()=>{!p&&k>200&&(k=Math.max(200,k-25),N())},1e4)}function Y(){u!==void 0&&clearInterval(u),u=setInterval(()=>{!p&&b<6&&(b+=1)},2e4)}function ie(){p=!0,w!==void 0&&(clearInterval(w),w=void 0),g!==void 0&&(clearInterval(g),g=void 0),u!==void 0&&(clearInterval(u),u=void 0),h.length=0,c.length=0}function se(){k=2e3,p=!1,b=1,G(),P(o.money),L(o.lives),z(o.monstersKilled),h.length=0,c.length=0,u!==void 0&&(clearInterval(u),u=void 0),N(),W(),Y(),H()}d.addEventListener("click",function(t){if(!p)return;const e=d.getBoundingClientRect(),s=t.clientX-e.left,r=t.clientY-e.top;s>=a.x&&s<=a.x+a.w&&r>=a.y&&r<=a.y+a.h&&se()});let B=null,I=null;window.addEventListener("keydown",t=>{if(t.key.toLowerCase()==="e"&&!p){B===null&&(B=Date.now(),I=window.setTimeout(()=>{K("okrzyk")},1e3)),K("shot");const e=o.fire();for(const s of e)c.push(s)}});window.addEventListener("keyup",t=>{t.key.toLowerCase()==="e"&&(B=null,I!==null&&(clearTimeout(I),I=null))});let A;function oe(){A=new V}document.querySelectorAll(".shopItem[data-type]").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-type");e&&ne(e)})});function ne(t){switch(t){case"ammo":A.buyAmmo(o),O(o.ammos);break;case"fasterShooting":A.buyAmmoSpeed(o);break;case"life":A.buyHealth(o),L(o.lives);break}P(o.money),X()}function re(t){Object.entries(t).forEach(([s,r])=>{const i=document.querySelector(`.itemProgress[data-type="${s}"]`);if(i){i.innerHTML="";for(let n=0;n<5;n++){const l=document.createElement("div");l.className="progressSquare"+(n<r?" filled":""),i.appendChild(l)}}})}function X(){re({ammo:0,fasterShooting:o.ammoSpeed-20,life:o.lives-3,upgradeWeapon:0})}G();oe();N();W();Y();H();X();
